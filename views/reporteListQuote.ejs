<!DOCTYPE html>
<html lang="en">
  <body style="margin-top: 0 !important">
    <div style="text-align: center">
      <h1 class="title">REPORTE DE QUOTE GENERAL</h1>
      <h3 class="subtitle"><%=sucursal %></h3>
    </div>
    <!-- Primera Sección: Total por Estatus y Resumen -->
    <div class="container">
      <div class="item">
        <h3>TOTAL POR ESTATUS:</h3>
        <table style="width: 100%;">
          <thead>
            <tr>
              <th class="headerDetalle">Estatus</th>
              <th class="headerDetalle">Cantidad</th>
            </tr>
          </thead>
          <tbody>
            <% 
            let totalEstatus = 0;
            if (countByStatusArray && countByStatusArray.length > 0) {
              countByStatusArray.forEach(element => {
                totalEstatus += element.total;
            %>
            <tr>
              <td><%= element.status %></td>
              <td style="text-align: center;"><%= element.total %></td>
            </tr>
            <%});%>
            <!-- Fila de Total -->
            <tr style="background-color: #f0f0f0; font-weight: bold;">
              <td><strong>TOTAL</strong></td>
              <td style="text-align: center;"><strong><%= totalEstatus %></strong></td>
            </tr>
            <%}%>
          </tbody>
        </table>
      </div>
      <div class="item">
        <h3>RESUMEN GENERAL:</h3>
        <table style="width: 100%;">
          <tbody>
            <tr>
              <td><strong>Total de Cotizaciones:</strong></td>
              <td style="text-align: right;"><strong><%= totalGeneral %></strong></td>
            </tr>
            <tr>
              <td><strong>Monto Total General:</strong></td>
              <td style="text-align: right;"><strong>$<%= montoTotalGeneral.toFixed(2) %></strong></td>
            </tr>
            <tr>
              <td><strong>Total de Clientes:</strong></td>
              <td style="text-align: right;"><strong><%= countByClientArray.length %></strong></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Segunda Sección: Total por Cliente -->
    <div class="container">
      <div class="item" style="width: 100% !important;">
        <h3>TOTAL POR CLIENTE:</h3>
        <table style="width: 100%;">
          <thead>
            <tr>
              <th class="headerDetalle">Cliente</th>
              <th class="headerDetalle">Cantidad</th>
              <th class="headerDetalle">Monto Total</th>
            </tr>
          </thead>
          <tbody>
            <% 
            let totalCantidadClientes = 0;
            let totalMontoClientes = 0;
            if (countByClientArray && countByClientArray.length > 0) {
              countByClientArray.forEach(element => {
                totalCantidadClientes += element.cantidad;
                totalMontoClientes += element.monto_total;
            %>
            <tr>
              <td><%= element.nombre %></td>
              <td style="text-align: center;"><%= element.cantidad %></td>
              <td style="text-align: right;">$<%= element.monto_total.toFixed(2) %></td>
            </tr>
            <%});%>
            <!-- Fila de Total -->
            <tr style="background-color: #f0f0f0; font-weight: bold;">
              <td><strong>TOTAL</strong></td>
              <td style="text-align: center;"><strong><%= totalCantidadClientes %></strong></td>
              <td style="text-align: right;"><strong>$<%= totalMontoClientes.toFixed(2) %></strong></td>
            </tr>
            <%} else {%>
            <tr>
              <td colspan="3" style="text-align: center;">No hay datos de clientes</td>
            </tr>
            <%}%>
          </tbody>
        </table>
      </div>
    </div>

    <table style="width: 100% !important">
      <thead>
        <tr>
          <th class="headerDetalle">FECHA</th>
          <th class="headerDetalle">ESTATUS</th>
          <th class="headerDetalle">CÓD</th>
          <th class="headerDetalle">CLIENTE</th>
          <th class="headerDetalle">TELÉFONO</th>
          <th class="headerDetalle">SENTIDO</th>
          <th class="headerDetalle">TIPO CARGA</th>
          <th class="headerDetalle">CCI</th>
          <th class="headerDetalle">ORIGEN</th>
          <th class="headerDetalle">DESTINO</th>
          <th class="headerDetalle">VENDEDOR</th>
          <th class="headerDetalle">ELIMINADO</th>
        </tr>
      </thead>
      <tbody>
        <% if (rows.length>0) {%> <% rows.forEach(element => {%>
        <tr>
          <td><%=element.created %></td>
          <td><%=element.status %></td>
          <td><%=element.codigo %></td>
          <td><%=element.nombres %></td>
          <td><%=element.telefono %></td>
          <td><%=element.sentido %></td>
          <td><%=element.tipo_de_carga %></td>
          <td><%=element.incoterms %></td>
          <td><%=element.origen %></td>
          <td><%=element.destino %></td>
          <td><%=element.ejecutivo_ventas %></td>
          <td>
            <% if (element.statusmain ==1 ) {%> NO <% } else { %> SI
            <% }%>
          </td>
        </tr>

        <% });%> <% }%>
      </tbody>
    </table>
  </body>
</html>
<style>
  * {
    font-size: 0.7rem !important;
  }

  .container {
    width: 100%;
    display: block;
  }

  .half {
    width: 50%;
    box-sizing: border-box;
    padding: 10px;
    border: 1px solid #000;
    display: inline-block;
    vertical-align: top; /* Alinea los elementos en la parte superior */
  }
  .headerDetalle {
    background: rgb(58, 17, 0);
    color: white;
  }
  .container {
    display: flex;
    width: 100%;
    margin: 1cm 0 2cm 0;
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: flex-start;
  }
  .item {
    float: left !important;
    width: 50% !important ;
  }
  .title {
    font-size: 1.5rem !important;
  }
  td,
  th {
    text-align: center;
    vertical-align: center;
    border-spacing: 0;
  }

  td {
    text-align: left;
  }
  .td {
    max-width: 100%;
    white-space: nowrap;
  }
  .subtitle {
    font-size: 1.2rem !important;
  }
</style>
